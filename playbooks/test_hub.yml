---
- name: Create Hub Groups via CaC in AAP 2.6
  hosts: localhost
  gather_facts: false
  connection: local

  collections:
    - infra.aap_configuration

  vars:
    controller_host: "https://controller.example.com"
    controller_username: "admin"
    controller_password: "redhat"
    validate_certs: false

    ah_groups:
      - name: "STT::group1"
        description: "Test group for Automation Hub"
        state: present

  roles:
    - role: infra.aap_configuration.hub_group
      vars:
        ah_groups: "{{ ah_groups }}"
        controller_host: "{{ controller_host }}"
        controller_username: "{{ controller_username }}"
        controller_password: "{{ controller_password }}"
        validate_certs: "{{ validate_certs }}"

  tasks:
    - name: Show Hub groups after role execution
      ansible.builtin.debug:
        var: ah_groups
