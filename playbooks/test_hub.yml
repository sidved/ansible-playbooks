---
- name: Create Automation Hub groups via Configuration as Code
  hosts: localhost
  gather_facts: false
  connection: local

  collections:
    - infra.aap_configuration

  vars:
    controller_host: "https://controller.example.com"    # Your Controller URL
    controller_username: "admin"
    controller_password: "redhat"
    validate_certs: false

    ah_groups:
      - name: "STT::group1"
        description: "Test group for AAP 2.6"
        state: present

  tasks:
    - name: Create Hub groups
      infra.aap_configuration.hub_group:
        ah_groups: "{{ ah_groups }}"
        controller_host: "{{ controller_host }}"
        controller_username: "{{ controller_username }}"
        controller_password: "{{ controller_password }}"
        validate_certs: "{{ validate_certs }}"
      register: result

    - name: Show result
      ansible.builtin.debug:
        var: result
